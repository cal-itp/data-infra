version: 2

sources:
  - name: external_enghouse
    description: External tables reading Enghouse payments data.
    database: "{{ env_var('GOOGLE_CLOUD_PROJECT', var('GOOGLE_CLOUD_PROJECT')) }}"
    schema: external_enghouse
    tables:
      - name: taps
      - name: ticket_results
      - name: transactions
      - name: pay_windows

models:
  - name: stg_enghouse__taps
    description: Add description
    columns:
      - name: operator_id
      - name: tap_id
      - name: mapping_terminal_id
      - name: mapping_merchant_id
      - name: terminal
      - name: token
      - name: masked_pan
      - name: expiry
      - name: server_date
      - name: terminal_date
      - name: tx_number
      - name: tx_status
      - name: payment_reference
      - name: terminal_spdh_code
      - name: denylist_version
      - name: transit_data
      - name: currency
      - name: par
      - name: fare_mode
      - name: fare_type
      - name: fare_value
      - name: fare_description
      - name: fare_linked_id
      - name: gps_longitude
      - name: gps_latitude
      - name: gps_altitude
      - name: vehicle_public_number
      - name: vehicle_name
      - name: stop_id
      - name: stop_name
      - name: platform_id
      - name: platform_name
      - name: zone_id
      - name: zone_name
      - name: line_public_number
      - name: line_name
      - name: line_direction
      - name: trip_public_number
      - name: trip_name
      - name: service_public_number
      - name: service_name
      - name: driver_id
      - name: _content_hash

  - name: stg_enghouse__ticket_results
    description: Add description
    columns:
      - name: operator_id
      - name: id
      - name: ticket_id
      - name: station_name
      - name: amount
      - name: clearing_id
      - name: reason
      - name: tap_id
      - name: ticket_type
      - name: created_dttm
      - name: line
      - name: start_station
      - name: end_station
      - name: start_dttm
      - name: end_dttm
      - name: ticket_code
      - name: additional_infos
      - name: _content_hash

  - name: stg_enghouse__transactions
    description: Add description
    columns:
      - name: operator_id
      - name: id
      - name: operation
      - name: terminal_id
      - name: mapping_terminal_id
      - name: mapping_merchant_id
      - name: timestamp
      - name: amount
      - name: payment_reference
      - name: spdh_response
      - name: response_type
      - name: response_message
      - name: token
      - name: issuer_response
      - name: core_response
      - name: rrn
      - name: authorization_code
      - name: par
      - name: brand
      - name: _content_hash

  - name: stg_enghouse__pay_windows
    description: Add description
    columns:
      - name: operator_id
      - name: id
      - name: token
      - name: amount_settled
      - name: amount_to_settle
      - name: debt_settled
      - name: stage
      - name: payment_reference
      - name: terminal_id
      - name: open_date
      - name: close_date
      - name: _content_hash
