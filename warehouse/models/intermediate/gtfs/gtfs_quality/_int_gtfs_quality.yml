version: 2

models:
  - name: int_gtfs_guidelines_v2__schedule_feed_guideline_index
    description: |
      Daily index of v2 schedule feeds. Provides structure for
      individual check models to be joined together by day.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - feed_key
            - date
  - name: int_gtfs_guidelines_v2__schedule_validation_severities
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - code
            - severity

  - name: int_gtfs_guidelines_v2__no_schedule_validation_errors
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date
            - feed_key
    columns:
      - name: status
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.99

  - name: int_gtfs_guidelines_v2__shapes_valid
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date
            - feed_key
    columns:
      - name: status
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.99
