version: 2

models:
  - name: fct_daily_trip_update_status_counts
    description: |
      Count of distinct trip IDs by date, feed, and update status.
    columns:
      - name: key
        description: |
          Synthetic primary key constructed from `dt`, `base64_url`.
        tests:
          - unique:
              where: dt >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)
          - not_null:
              where: dt >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)

  - name: fct_daily_vehicle_location_feed_trip_counts
    description: |
      Count of distinct trip IDs by date and vehicle locations feed.
    columns:
      - name: key
        description: |
          Synthetic primary key constructed from `dt`, `base64_url`.
        tests:
          - unique:
              where: dt >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)
          - not_null:
              where: dt >= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)

  - name: fct_scheduled_service_by_daypart
    description: |
      An aggregation of GTFS schedule service by day and time characteristics.
    columns:
      - name: name
      - name: source_record_id
      - name: route_id
      - name: route_short_name
      - name: shape_id
      - name: time_of_day
      - name: hour
      - name: month
      - name: year
      - name: day_type
      - name: n_trips
