{{ config(materialized='table') }}

WITH stg_transit_data_quality_issues__gtfs_datasets AS (
    SELECT * FROM {{ ref('stg_transit_data_quality_issues__gtfs_datasets') }}
),

dim_transit_data_quality_gtfs_datasets AS (
    SELECT
        id,
        dataset_publisher,
        pipeline_url,
        operator,
        provider,
        organizations_copy,
        manual_check__localized_stop_tts,
        transit_data_quality_issues,
        manual_check__authentication_acceptable,
        name,
        gtfs_service_mapping,
        feed_metrics,
        manual_check__link_to_dataset_on_website,
        notes,
        feature_progress__feed_aggregator_availability,
        data_owner,
        temp_dataset_uris,
        category,
        data_quality_pipeline,
        qc__number_of_duplicate_pipeline_urls,
        uri,
        service_type,
        manual_check__accurate_shapes,
        data,
        itp_schedule_todo,
        provider_reporting_category__from_gtfs_service_mapping_,
        qc__has_minimum_required_fields,
        itp_activities,
        pathways_status,
        qc__count_of_data_owner,
        qc__airtable_hack___unique_pipeline_url,
        qc__number_of_duplicate_uris,
        customer_facing__from_gtfs_service_mapping_,
        qc__airtable_hack___unique_uri,
        website__from_services___from_gtfs_service_mapping_,
        manual_check__stable_url,
        manual_check__grading_scheme_v1,
        qc_automations,
        last_url_update,
        fares_v2_status,
        manual_check__data_license,
        reference_schedule_providers_match_rt_providers,
        qc__duplicate_data_owner,
        services,
        dataset_producers,
        authorization_header_parameter_name,
        schedule_to_use_for_rt_validation,
        header_secret_key_name,
        reference_schedule_provider,
        url_secret_key_name,
        authorization_url_parameter_name,
        aggregated_to,
        regional_feed_type,
        regional_gtfs_partner_organization__from_provider___from_services___from_gtfs_service_mapping_,
        fares_notes,
        provider_gtfs_capacity,
        deprecated_date,
        data_quality_pipeline_disabled_notes,
        future_uri,
        schedule_comments,
    FROM stg_transit_data_quality_issues__gtfs_datasets
)

SELECT * FROM dim_transit_data_quality_gtfs_datasets
