version: 2
models:
  - name: dim_annual_ntd_agency_information
    description: >
      Versioned extracts of the NTD Annual Database Agency Information.

      For example, the 2021 dataset is found at
      https://www.transit.dot.gov/ntd/data-product/2021-annual-database-agency-information.

      Only contains 2021 data as of 2022-02-08 but we will be importing

      more data in the future.

      The versioning is bitemporal, so records are versioned at the year

      and ntd_id level. This means you must join based on
      _valid_from/_valid_from

      to get the records for a given ntd_id, and then choose which year to

      look up.
    tests:
      - dbt_utils.mutually_exclusive_ranges:
          lower_bound_column: _valid_from
          upper_bound_column: _valid_to
          partition_by: CONCAT(year, '_', ntd_id)
          gaps: required
    columns:
      - name: key
        tests:
          - not_null
          - unique
      - name: year
        tests:
          - not_null
      - name: ntd_id
        tests:
          - not_null
      - name: _valid_from
        tests:
          - not_null
      - name: _valid_to
        tests:
          - not_null
      - name: _is_current
        tests:
          - not_null
  - name: dim_annual_funding_sources
    description: >-
      This dataset details federal, state, and local funding sources for each applicable agency reporting to the NTD in Report Year 2022.
      Federal funding sources are financial assistance obtained from the Federal Government to assist with the costs of providing transit services.
      NTD Data Tables organize and summarize data from the 2022 National Transit Database in a manner that is more useful for quick reference and summary analysis.
      This dataset is based on the 2022 Revenue Sources database file.

      Source documents:
        https://data.transportation.gov/Public-Transit/2022-NTD-Annual-Data-Funding-Sources-Federal-/qpjk-b3zw/about_data
        https://data.transportation.gov/Public-Transit/2022-NTD-Annual-Data-Funding-Sources-State-/dd43-h6wv/about_data
        https://data.transportation.gov/Public-Transit/2022-NTD-Annual-Data-Funding-Sources-Local-/8tvb-ywj3/about_data
    columns:
      - name: funding_source
        description: |
          The table that originated the funding source information.
          The options are: "federal", "state", and "local".
        tests:
          - accepted_values:
              values: ["federal", "state", "local"]
      - name: agency
        description: The transit agency's name.
      - name: agency_voms
        description: |
          The number of revenue vehicles operated across the whole agency to meet the annual maximum service requirement.
          This is the revenue vehicle count during the peak season of the year; on the week and day that maximum service is provided.
          Vehicles operated in maximum service (VOMS) exclude atypical days and one-time special events.
      - name: city
        description: The city in which the agency is headquartered.
      - name: fuel_tax
        description: |
          Revenue from taxing fuel.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: fta_capital_program_5309
        description: |
          The Capital Program provided capital assistance for three primary activities:
          - New and replacement buses and facilities,
          - Modernization of existing fixed guideway (FG) systems,
          - New fixed FG systems In MAP-21.
          The Capital Program was split into three separate programs.
          The State of Good Repair program is one of these successor programs.
          The other two are the Bus and Bus Facilities (5339) program and the Fixed Guideway Capital Investment (5309) program.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: fta_rural_progam_5311
        description: |
          This program provides formula funding to States and Indian Tribes for supporting public transportation in areas with a population of less than 50,000.
          Funding may be used for capital, operating, State administration, and project administration expenses.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: fta_urbanized_area_formula
        description: |
          The Urbanized Area Formula Funding program (49 U.S.C. 5307) provides Federal resources to urbanized areas for transit capital and operating assistance and for transit related planning.
          The Bus and Bus Facilities program is a formula program that finances capital projects to replace, rehabilitate, and purchase buses and related equipment and to construct bus-related facilities.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: general_funds
        description: |
          Any funds allocated to transit out of the general revenues of the local or state government.
          General revenue funds are usually granted through a state or local governmentâ€™s annual budgeting process.
          *ONLY for Local and State Funding Sources (funding_source IN ("local", "state"))
      - name: income_tax
        description: |
          Revenue from taxing income.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: ntd_id
        description: A five-digit identifying number for each agency used in the current NTD system.
      - name: organization_type
        description: Description of the agency's legal entity.
      - name: other_dot_funds
        description: |
          Funding from grants provided by divisions of the federal Department of Transportation other than FTA.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: other_federal_funds
        description: |
          Funding from departments of the federal government other than Transportation.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: other_fta_funds
        description: |
          Funding from FTA grants other than the ones already listed (5307, 5339, 5309, 5337, 5311).
          May include:
          - 5303 Metropolitan Planning,
          - 5308 Clean Fuels,
          - 5310 Special Needs/ADA,
          - 5316 Job Access and Reverse Commute,
          - 5317 New Freedom,
          - 5320 Transit in the Park.
          *ONLY for Federal Funding Sources (funding_source = "federal")
      - name: other_funds
        description: |
          Revenue from funds imposed on the public other than taxes, such as:
          - Vehicle licensing and registration fees,
          - Lottery and casino proceeds,
          - Sale of property and assets.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: other_taxes
        description: |
          Revenues generated from a charge imposed by the state or local government, or independent political entity (e.g., transit authority) on persons or property to help pay expenses, including:
          - Payroll taxes,
          - Utility taxes,
          - Communication taxes (e.g., telephone taxes),
          - Motor vehicle and tire excise taxes.
          But excluding:
          - Income taxes,
          - Property taxes,
          - Sales taxes,
          - Fuel taxes.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: primary_uza_population
        description: The population of the urbanized area primarily served by the agency.
      - name: property_tax
        description: |
          Revenue from taxing property.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: reduced_reporter_funds
        description: |
          Local and State funding sources reported by agencies that do not report funding sources in specific categories because they have reduced reporting requirements.
          *ONLY for Local and State Funding Sources (funding_source IN ("local", "state"))
      - name: report_year
        description: The year for which the data was reported.
        tests:
          - accepted_values:
              values: [2022]
      - name: reporter_type
        description: The type of NTD report that the agency completed this year.
      - name: sales_tax
        description: |
          Revenue from taxing sales.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: state
        description: The state in which the agency is headquartered.
      - name: tolls
        description: |
          Revenue from tolls on bridges, highways, and high occupancy/toll lanes.
          *ONLY for Local Funding Sources (funding_source = "local")
      - name: transportation_funds
        description: |
          *ONLY for State Funding Sources (funding_source = "state")
      - name: uace_code
        description: UACE Code remains consistent across census years.
      - name: uza_name
        description: The name of the agency's Urbanized Area.
  - name: dim_annual_service_agencies
    description: >-
      Provides transit agency-wide totals for service data for applicable agencies reporting to the National Transit Database in the 2022 report year.
      This view displays the data at a higher level (by agency), based on the "2022 NTD Annual Data - Service (by Mode and Time Period)" dataset.
      In the years 2015-2021, you can find this data in the "Service" data table on NTD Program website, at https://transit.dot.gov/ntd/ntd-data.
      In versions of the data tables from before 2014, you can find data on service in the file called "Transit Operating Statistics: Service Supplied and Consumed."
    columns:
      - name: key
        tests:
          - not_null
          - unique
      - name: report_year
        description: The year for which the data was reported.
        tests:
          - accepted_values:
              values: [2022]
      - name: ntd_id
        description: A five-digit identifying number for each agency used in the current NTD system.
      - name: agency
        description: The transit agency's name.
      - name: reporter_type
        description: The type of NTD report that the agency completed this year.
      - name: organization_type
        description: Description of the agency's legal entity.
      - name: city
        description: The city in which the agency is headquartered.
      - name: state
        description: The state in which the agency is headquartered.
      - name: agency_voms
        description: |
          The number of revenue vehicles operated across the whole agency to meet the annual maximum service requirement.
          This is the revenue vehicle count during the peak season of the year; on the week and day that maximum service is provided.
          Vehicles operated in maximum service (VOMS) exclude atypical days and one-time special events.
      - name: primary_uza_code
        description: UACE Code remains consistent across census years.
      - name: primary_uza_name
        description: The name of the agency's Urbanized Area.
      - name: primary_uza_area_sq_miles
        description: The agency's Urbanized Area's size in square miles.
      - name: max_primary_uza_population
        description: The population of the urbanized area primarily served by the agency.
      - name: max_service_area_sq_miles
        description: The agency's service area's size in square miles.
      - name: max_service_area_population
        description: The population of the service area served by the agency.
      - name: actual_vehicles_passenger_car_deadhead_hours
        description: |
          The hours that a vehicle/passenger car travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: actual_vehicles_passenger_car_hours
        description: |
          The hours that vehicles/passenger cars travel while in revenue service plus deadhead hours.
          Actual vehicle hours include:
            - Revenue service,
            - Deadhead,
            - Layover/recovery time.
          Actual vehicle hours exclude:
            - Hours for charter service,
            - School bus service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: actual_vehicles_passenger_car_miles
        description: |
          The miles that vehicles/passenger cars travel while in revenue service (actual vehicle revenue miles (VRM)) plus deadhead miles.
          Actual vehicle miles include:
            - Revenue service,
            - Deadhead.
          Actual vehicle miles exclude:
            - Miles for charter services,
            - School bus service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: actual_vehicles_passenger_car_revenue_hours
        description: |
          The hours that vehicles/passenger cars travel while in revenue service.
          Vehicle revenue hours (VRH) include:
            - Revenue service,
            - Layover/recovery time.
          Actual vehicle revenue hours exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - School bus and charter services.
      - name: actual_vehicles_passenger_car_revenue_miles
        description: |
          The miles that vehicles/passenger cars travel while in revenue service.
          Vehicle revenue miles (VRM) include:
            - Revenue service.
          Actual vehicle revenue miles exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - School bus and charter services.
      - name: actual_vehicles_passenger_deadhead_miles
        description: |
          The miles that a vehicle/passenger car travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: scheduled_vehicles_passenger_car_revenue_miles
        description: |
          The total service scheduled to be provided for picking up and discharging passengers.
          Scheduled service is computed from internal transit agency planning documents (e.g., run paddles, trip tickets, and public timetables).
          Scheduled service excludes special additional services.
      - name: charter_service_hours
        description: Hours run in charter service.
      - name: school_bus_hours
        description: Hours run in school bus service.
      - name: trains_in_operation
        description: The maximum number of trains actually operated to provide service during the year.
      - name: directional_route_miles
        description: |
          The mileage in each direction over which public transportation vehicles travel while in revenue service.
          Directional route miles (DRM) are:
          - A measure of the route path over a facility or roadway, not the service carried on the facility; e.g., number of routes, vehicles, or vehicle revenue miles.
          - Computed with regard to direction of service, but without regard to the number of traffic lanes or rail tracks existing in the right-of-way (ROW).
          Directional route miles (DRM) do not include staging or storage areas at the beginning or end of a route.
      - name: passenger_miles
        description: The cumulative sum of the distances ridden by each passenger.
      - name: train_miles
        description: |
          The miles that trains travel while in revenue service (actual vehicle revenue miles (VRM)) plus deadhead miles.
          Train miles include:
            - Revenue service,
            - Deadhead.
          Train miles exclude:
            - Miles for charter services,
            - Operator training,
            - Vehicle maintenance testing.
      - name: train_revenue_miles
        description: |
          The miles that trains travel while in revenue service.
          Train revenue miles include:
            - Revenue service.
          Train revenue miles exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - Charter services.
      - name: train_deadhead_miles
        description: |
          The miles that a train travels when out of revenue service. Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: train_hours
        description: |
          The hours that trains travel while in revenue service plus deadhead hours.
          Train hours include:
            - Revenue service,
            - Deadhead,
            - Layover/recovery time,
          Train hours exclude:
            - Hours for charter service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: train_revenue_hours
        description: |
          The hours that trains travel while in revenue service. Train revenue hours include:
            - Revenue service,
            - Layover/recovery time.
          Train revenue hours exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - Charter services.
      - name: train_deadhead_hours
        description: |
          The hours that a train travels when out of revenue service. Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: ada_upt
        description: Unlinked Passenger Trips embarked per stipulations of the Americans with Disabilities Act.
      - name: sponsored_service_upt
        description: Unlinked Passenger Trips embarked under sponsored service.
      - name: unlinked_passenger_trips_upt
        description: |
          The number of passengers who board public transportation vehicles.
          Passengers are counted each time they board a vehicle no matter how many vehicles they use to travel from their origin to their destination.
  - name: dim_annual_service_mode_time_periods
    description:
      This represents the Service data reported to the NTD by transit agencies in the 2022 report year.
    columns:
      - name: key
        tests:
          - not_null
          - unique
      - name: report_year
        description: The year for which the data was reported.
        tests:
          - accepted_values:
              values: [2022]
      - name: reporter_type
        description: The type of NTD report that the agency completed this year.
      - name: ntd_id
        description: A five-digit identifying number for each agency used in the current NTD system.
      - name: agency
        description: The transit agency's name.
      - name: type_of_service
        description: |
          Describes how public transportation services are provided by the transit agency:
            directly operated (DO) or purchased transportation (PT) services.
      - name: mode
        description: A system for carrying transit passengers described by specific right-of-way (ROW), technology and operational features.
      - name: mode_name
        description: A system for carrying transit passengers described by specific right-of-way (ROW), technology and operational features.
      - name: time_period
        description: |
          The time period for which data was collected:
            - Annual Total,
            - Average Weekday - AM Peak,
            - Average Weekday - Midday,
            - Average Weekday - PM Peak,
            - Average Weekday - Other,
            - Average Typical Weekday,
            - Average Typical Saturday,
            - Average Typical Sunday.
        tests:
          - accepted_values:
              values: ["Average Weekday - AM Peak", "Average Weekday - Midday", "Average Weekday - PM Peak", "Average Weekday - Other", "Average Typical Weekday", "Average Typical Saturday", "Average Typical Sunday"]
      - name: time_service_begins
        description: The time at which a particular mode/type of service begins revenue service, presented in a 24-hour format.
      - name: time_service_ends
        description: The time at which a particular mode/type of service ends revenue service, presented in a 24-hour format.
      - name: organization_type
        description: Description of the agency's legal entity.
      - name: city
        description: The city in which the agency is headquartered.
      - name: state
        description: The state in which the agency is headquartered.
      - name: primary_uza_code
        description: UACE Code remains consistent across census years.
      - name: primary_uza_name
        description: The name of the agency's Urbanized Area.
      - name: primary_uza_area_sq_miles
        description: The agency's Urbanized Area's size in square miles.
      - name: primary_uza_population
        description: The population of the urbanized area primarily served by the agency.
      - name: service_area_population
        description: The population of the service area served by the agency.
      - name: service_area_sq_miles
        description: The agency's service area's size in square miles.
      - name: days_of_service_operated
        description: Days of revenue service within the fiscal year.
      - name: days_not_operated_strikes
        description: Days of revenue service not operated due to strikes.
      - name: days_not_operated_emergencies
        description: Days of revenue service not operated due to emergencies.
      - name: agency_voms
        description: |
          The number of revenue vehicles operated across the whole agency to meet the annual maximum service requirement.
          This is the revenue vehicle count during the peak season of the year; on the week and day that maximum service is provided.
          Vehicles operated in maximum service (VOMS) exclude atypical days and one-time special events.
      - name: mode_voms
        description: |
          The number of revenue vehicles operated by the given mode and type of service to meet the annual maximum service requirement.
          This is the revenue vehicle count during the peak season of the year; on the week and day that maximum service is provided.
          Vehicles operated in maximum service (VOMS) exclude atypical days and one-time special events.
      - name: mode_voms_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_car_miles
        description: |
          The miles that vehicles/passenger cars travel while in revenue service (actual vehicle revenue miles (VRM)) plus deadhead miles.
          Actual vehicle miles include:
            - Revenue service,
            - Deadhead.
          Actual vehicle miles exclude:
            - Miles for charter services,
            - School bus service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: vehicle_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_car_revenue_miles
        description: |
          The miles that vehicles/passenger cars travel while in revenue service.
          Vehicle revenue miles (VRM) include:
            - Revenue service.
          Actual vehicle revenue miles exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - School bus and charter services.
      - name: vehicle_revenue_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_deadhead_miles
        description: |
          The miles that a vehicle/passenger car travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: deadhead_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: scheduled_vehicles_passenger_car_revenue_miles
        description: |
          The total service scheduled to be provided for picking up and discharging passengers.
          Scheduled service is computed from internal transit agency planning documents (e.g., run paddles, trip tickets, and public timetables).
          Scheduled service excludes special additional services.
      - name: scheduled_revenue_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_car_hours
        description: |
          The hours that vehicles/passenger cars travel while in revenue service plus deadhead hours.
          Actual vehicle hours include:
            - Revenue service,
            - Deadhead,
            - Layover/recovery time.
          Actual vehicle hours exclude:
            - Hours for charter service,
            - School bus service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: vehicle_hours_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_car_revenue_hours
        description: |
          The hours that vehicles/passenger cars travel while in revenue service.
          Vehicle revenue hours (VRH) include:
            - Revenue service,
            - Layover/recovery time.
          Actual vehicle revenue hours exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - School bus and charter services.
      - name: vehicle_revenue_hours_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: actual_vehicles_passenger_car_deadhead_hours
        description: |
          The hours that a vehicle/passenger car travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: deadhead_hours_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: charter_service_hours
        description: Hours run in charter service.
      - name: school_bus_hours
        description: Hours run in school bus service.
      - name: trains_in_operation
        description: The maximum number of trains actually operated to provide service during the year.
      - name: trains_in_operation_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: train_miles
        description: |
          The miles that trains travel while in revenue service (actual vehicle revenue miles (VRM)) plus deadhead miles.
          Train miles include:
            - Revenue service,
            - Deadhead.
          Train miles exclude:
            - Miles for charter services,
            - Operator training,
            - Vehicle maintenance testing.
      - name: train_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: train_revenue_miles
        description: |
          The miles that trains travel while in revenue service.
          Train revenue miles include:
            - Revenue service.
          Train revenue miles exclude:
            - Deadhead,
            - Operator training,
            - Maintenance testing,
            - Charter services.
      - name: train_revenue_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: train_deadhead_miles
        description: |
          The miles that a train travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: train_hours
        description: |
          The hours that trains travel while in revenue service plus deadhead hours.
          Train hours include:
            - Revenue service,
            - Deadhead,
            - Layover/recovery time.
          Train hours exclude:
            - Hours for charter service,
            - Operator training,
            - Vehicle maintenance testing.
      - name: train_hours_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: train_revenue_hours
        description: |
          The hours that trains travel while in revenue service.
          Train revenue hours include:
            - Revenue service,
            - Layover/recovery time.
          Train revenue hours exclude:
            - Deadhead,
            - Operator training ,
            - Maintenance testing,
            - Charter services.
      - name: train_revenue_hours_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: train_deadhead_hours
        description: |
          The hours that a train travels when out of revenue service.
          Deadhead includes:
            - Leaving or returning to the garage or yard facility,
            - Changing routes,
            - When there is no expectation of carrying revenue passengers.
          However, deadhead does not include:
            - Charter service,
            - School bus service,
            - Travel to fueling facilities,
            - Travel to maintenance facilities,
            - Operator training,
            - Maintenance testing.
      - name: unlinked_passenger_trips_upt
        description: |
          The number of passengers who board public transportation vehicles.
          Passengers are counted each time they board a vehicle no matter how many vehicles they use to travel from their origin to their destination.
      - name: unlinked_passenger_trips_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: ada_upt
        description: Unlinked Passenger Trips embarked per stipulations of the Americans with Disabilities Act.
      - name: sponsored_service_upt
        description: Unlinked Passenger Trips embarked under sponsored service.
      - name: average_passenger_trip_length_aptl_
        description: |
          The average distance ridden by each passenger in a single trip, computed as passenger miles traveled (PMT) divided by unlinked passenger trips (UPT).
          May be determined by sampling, or calculated based on actual data.
      - name: aptl_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: average_speed
        description: The average speed of a vehicle/passenger car during revenue service.
      - name: average_speed_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: brt_non_statutory_mixed_traffic
        description: |
          Miles of roadway for Bus Rapid Transit modes which, while part of bus rapid transit system routes, are not considered fixed guideway for federal funding allocation purposes.
          These are rare exceptions resulting from FTAâ€™s review of each BRT system.
      - name: mixed_traffic_right_of_way
        description: |
          Roadways other than exclusive and controlled access rights-of-way (ROW) used for transit operations that are mixed with pedestrian and/or vehicle traffic.
          Does not include guideways that have only grade crossings with vehicular traffic.
      - name: directional_route_miles
        description: |
          The mileage in each direction over which public transportation vehicles travel while in revenue service.
          Directional route miles (DRM) are:
            - A measure of the route path over a facility or roadway, not the service carried on the facility; e.g., number of routes, vehicles, or vehicle revenue miles.
            - Computed with regard to direction of service, but without regard to the number of traffic lanes or rail tracks existing in the right-of-way (ROW).
          Directional route miles (DRM) do not include staging or storage areas at the beginning or end of a route.
      - name: directional_route_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: passenger_miles
        description: The cumulative sum of the distances ridden by each passenger.
      - name: passenger_miles_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
      - name: passengers_per_hour
        description: |
          The average number of passengers to board a vehicle/passenger car in one hour of service.
          For trains, this applies to passengers per hour on a single train car.
      - name: passengers_per_hour_questionable
        description: |
          FTA marks a data point as Questionable when there is reason to believe it is incorrect,
          but the reporting agency has been unable to correct the data or offer an explanation for its anomalous appearance.
  - name: dim_monthly_ntd_ridership_with_adjustments
    description: >-
      Extracts of the NTD Monthly Ridership with adjustments - VRM, VOMS, VRH,
      and UPT

      For example, the Feb 2024 dataset is found at
      https://www.transit.dot.gov/ntd/data-product/monthly-module-adjusted-data-release.

      Users are encouraged to use the glossary of transit terms located at
      https://www.transit.dot.gov/ntd/national-transit-database-ntd-glossary or
      the reporting manuals located at https://www.transit.dot.gov/ntd/manuals
      for more detailed information.

      A Master File of all properties that currently report or reported monthly
      data during the period January 2002 - Current Calendar Year. The following
      data elements are included in the master file and reflect the data
      reported in the Annual module for the most recently reported fiscal year:"

      NTD ID â€“ The Transit Propertyâ€™s NTD identification number in the Next
      Generation NTD Database

      Legacy NTD ID â€“ The Transit Propertyâ€™s NTD identification number in the
      Legacy NTD Database

      Name â€“ The Transit Propertyâ€™s legal name

      Mode â€“ Indicates the means of conveyance used for the service. The NTD
      recognizes a number of different modes including Motorbus (MB), Heavy Rail
      (HR), Light Rail (LR), and Demand Response (DR), among others.

      Type of Service â€“ Indicates whether the service is directly operated by
      the transit property, or is operated by a third party through a purchased
      transportation agreement.

      3 Mode - A grouping of modes based upon whether the mode operates on rail,
      is a bus mode, is ferry boat service or other.

      Status â€“ Indicates whether a property reports (active) or not (inactive)
      during the most recent Annual report year.

      HQ City â€“ The city where the propertyâ€™s headquarters (HQ) is located.

      HQ State â€“ The state where the propertyâ€™s headquarters (HQ) is located.

      Reporter Type - Indicates the agency's reporter type (Building Reporter,
      Full Reporter, Reduced Asset Reporter,  Rural Reporter, Separate Service
      Reporter or Small System Waiver Reporter) as of their most recent report
      year.

      Organization Type â€“ Indicates the agency's organization type as of their
      most recent report year.

      Urban Area Census Code (UACE)  â€“ A unique numeric identifier associated
      with the 2020 urban areas as defined by the U.S. Census.

      Urbanized Area Name â€“ The name of the urbanized area as defined by the
      U.S. Census

      Urbanized Area Population â€“ The population of the urbanized area as
      reported by the U.S. Census. This is the population count for the year the
      census was made. No population updates are made until the next Census
      (2020).

      Urbanized Area Square Miles â€“ The square miles of the urbanized area as
      reported by the U.S. census.

      Property Service Area â€“ The square miles of the area served by the
      property, as reported by the transit property. This may include some rural
      (non-urbanized) areas.

      Property Service Area Population â€“ The population of the area served by
      the property, as reported by the transit property.

      Most Recent Report Year (Annual module) â€“ The propertyâ€™s most-recent
      closed-out annual report year.

      Fiscal Year Month â€“ The month the propertyâ€™s fiscal year ends.

      Fiscal Year End â€“ The year in which the propertyâ€™s most-recent closed-out
      fiscal year ended.

      Passenger Miles - For the most recent closed-out annual report year.

      Unlinked Passenger Trips â€“ For the most recent closed-out annual report
      year.

      Average Trip Length â€“ The ratio of Passenger Miles per Unlinked Passenger
      trips.

      Fares â€“ The fare revenues collected during the most recent closed-out
      annual report year.

      Operating Expenses â€“ For the most recent closed-out annual report year.

      Avg. Cost per Trip â€“ The ratio of Total Operating Expenses per Unlinked
      Passenger Trips

      Avg. Fares per Trip â€“ The ratio of Fares Earned per Unlinked Passenger
      Trips
    columns:
      - name: uza_name
        description: Urbanized Area Name â€“ The name of the urbanized area as defined by
          the U.S. Census
      - name: uace_cd
        description: "Urban Area Census Code (UACE)  â€“ A unique numeric identifier
          associated with the 2020 urban areas as defined by the U.S. Census. "
      - name: _dt
        description: ""
      - name: ts
        description: ""
      - name: ntd_id
        description: NTD ID â€“ The Transit Propertyâ€™s NTD identification number in the
          Next Generation NTD Database
        tests:
          - not_null
      - name: year
        description: The year this data was added to the mart and thus the ntd_id's year
          as well.
      - name: reporter_type
        description: Reporter Type - Indicates the agency's reporter type (Building
          Reporter, Full Reporter, Reduced Asset Reporter,  Rural Reporter,
          Separate Service Reporter or Small System Waiver Reporter) as of their
          most recent report year.
      - name: agency
        description: Name â€“ The Transit Propertyâ€™s legal name
      - name: mode_type_of_service_status
        description: Status â€“ Indicates whether a property reports (active) or not
          (inactive) during the most recent Annual report year.
      - name: mode
        description: Mode â€“ Indicates the means of conveyance used for the service. The
          NTD recognizes a number of different modes including Motorbus (MB),
          Heavy Rail (HR), Light Rail (LR), and Demand Response (DR), among
          others.
      - name: service_type
        description: A summarization of modes into Fixed Route and Demand Response
      - name: _3_mode
        description: 3 Mode - A grouping of modes based upon whether the mode operates
          on rail, is a bus mode, is ferry boat service or other.
      - name: tos
        description: Type of Service â€“ Indicates whether the service is directly
          operated by the transit property, or is operated by a third party
          through a purchased transportation agreement.
      - name: legacy_ntd_id
        description: Legacy NTD ID â€“ The Transit Propertyâ€™s NTD identification number in
          the Legacy NTD Database
      - name: period_year_month
        description: ""
      - name: period_month
        description: ""
      - name: period_year
        description: ""
      - name: upt
        description: >-
          Unlinked Passenger Trips (UPT)

          The number of passengers who board public transportation vehicles.
          Passengers are counted each time they board vehicles no matter how
          many vehicles they use to travel from their origin to their
          destination.
      - name: vrm
        description: >-
          Vehicle Revenue Miles (VRM)

          The miles that vehicles are scheduled to or actually travel while in
          revenue service. Vehicle revenue miles include:

          â€¢   Layover / recovery time.

          Vehicle revenue miles exclude:

          â€¢   Deadhead;

          â€¢   Operator training;

          â€¢   Vehicle maintenance testing; and

          â€¢   Other non-revenue uses of vehicles.
      - name: vrh
        description: >-
          Vehicle Revenue Hours (VRH)

          The hours that vehicles are scheduled to or actually travel while in
          revenue service. Vehicle revenue hours include:

          â€¢   Layover / recovery time.

          Vehicle revenue hours exclude:

          â€¢   Deadhead;

          â€¢   Operator training;

          â€¢   Vehicle maintenance testing; and

          â€¢   Other non-revenue uses of vehicles.
      - name: voms
        description: >-
          Vehicles Operated in Annual Maximum Service (VOMS)

          The number of revenue vehicles operated to meet the annual maximum
          service requirement. This is the revenue vehicle count during the peak
          season of the year; on the week and day that maximum service is
          provided. Vehicles operated in maximum service (VOMS) exclude:

          â€¢   Atypical days; or

          â€¢   One-time special events.
  - name: fct_annual_service_modes
    description:
      View based on 2022 NTD Annual Data - Service (by Mode and Time Period)
      View of Service by Mode and Time Period filtered to preserve only the Annual Total time period.
      Useful for analyses of Annual Total service data.
    columns:
      - name: key
        tests:
          - not_null
          - unique
      - name: report_year
        description: The year for which the data was reported.
        tests:
          - accepted_values:
              values: [2022]
      - name: ntd_id
        description: A five-digit identifying number for each agency used in the current NTD system.
      - name: type_of_service
        description: |
          Describes how public transportation services are provided by the transit agency: directly operated (DO) or purchased transportation (PT) services.
      - name: mode
        description: A system for carrying transit passengers described by specific right-of-way (ROW), technology and operational features.
      - name: mode_name
        description: A system for carrying transit passengers described by specific right-of-way (ROW), technology and operational features.
      - name: questionable_record
        description: Indicates whether there was questionable data for the given given record.
      - name: max_time_period
        description: |
          The time period for which data was collected.
          This table displays only "Annual Total".
        tests:
          - accepted_values:
              values: ["Annual Total"]
