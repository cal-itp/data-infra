version: 2
exposures:
  - name: number_of_first_time_customers_per_week
    label: Number of First-time Customers per Week
    description: "### Visualization: Bar\n\nNo description provided in Metabase\n\n\
      #### Query\n\n```\nWITH \ncustomer_first_rides AS (\n    SELECT\n        `principal_customer_id`,\n\
      \        MIN(`transaction_date_time_pacific`) AS `transaction_date_time_pacific`\n\
      \    FROM `cal-itp-data-infra.views.payments_rides` AS `views.payments_rides`\n\
      \    WHERE true\n      [[AND (participant_id)]]\n    GROUP BY `principal_customer_id`\n\
      )\nSELECT\n    datetime_trunc(`transaction_date_time_pacific`, week(sunday))\
      \ AS `transaction_week`,\n    count(`principal_customer_id`) AS `count__principal_customer_id`\n\
      FROM `customer_first_rides`\nJOIN `cal-itp-data-infra.views.payments_rides`\
      \ AS `views.payments_rides`\n    USING (`principal_customer_id`, `transaction_date_time_pacific`)\
      \  -- Chances for fanout here are pretty small; the join is only necessary so\
      \ that we can use the filter variable below.\nWHERE true\n  [[AND (transaction_date_time_pacific)]]\n\
      GROUP BY `transaction_week`\nORDER BY `transaction_week`\n```\n\n#### Metadata\n\
      \nMetabase ID: __258__\n\nCreated On: __2022-01-27T22:02:42.379714Z__"
    type: analysis
    url: https://dashboards.calitp.org/card/258
    maturity: medium
    owner:
      name: Mjumbe Poe
      email: mjumbe.p@jarv.us
    depends_on: []
    config:
      meta:
        average_query_time: '0:00.977'
        last_used_at: '2025-02-20T19:31:59.138247Z'
