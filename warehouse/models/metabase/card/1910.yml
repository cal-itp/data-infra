version: 2
exposures:
  - name: median_ride_distance_per_route__miles_
    label: Median Ride Distance per Route (Miles)
    description: "### Visualization: Bar\n\nNo description provided in Metabase\n\n\
      #### Query\n\n```\nSELECT DISTINCT\n  `route_id`, \n  PERCENTILE_CONT(\n   \
      \ ST_DISTANCE(\n      ST_GEOGPOINT(CAST(`longitude` AS FLOAT64), CAST(`latitude`\
      \ AS FLOAT64)),\n      ST_GEOGPOINT(CAST(`off_longitude` AS FLOAT64), CAST(`off_latitude`\
      \ AS FLOAT64))\n    ), 0.5) OVER (PARTITION BY `route_id`) / 1609.34 as `median_ride_distance`\n\
      FROM `mart_payments.fct_payments_rides_v2`\n-- Filter out lat/long values =\
      \ 0.0 from Littelpay data\nWHERE `longitude` != 0.0 \nAND `latitude` != 0.0\
      \ \nAND `off_longitude` != 0.0 \nAND `off_latitude` != 0.0 \n[[AND (transaction_date_time_pacific)]]\n\
      ORDER BY `route_id`\n```\n\n#### Metadata\n\nMetabase ID: __1910__\n\nCreated\
      \ On: __2023-11-06T17:46:26.109595Z__"
    type: analysis
    url: https://dashboards.calitp.org/card/1910
    maturity: medium
    owner:
      name: Charlie Costanzo
      email: charlie.c@jarv.us
    depends_on: []
    config:
      meta:
        average_query_time: '0:01.009'
        last_used_at: '2024-09-20T17:54:54.131902Z'
