version: 2
exposures:
  - name: freshness_checks___ccjpa
    label: Freshness Checks - CCJPA
    description: "### Visualization: Table\n\nNo description provided in Metabase\n\
      \n#### Query\n\n```\nwith max_recency as (\n    select \n        participant_id,\
      \ \n        max(cast(transaction_date_time_pacific as TIMESTAMP)) as max_timestamp\n\
      \    from\n        `cal-itp-data-infra`.`mart_payments`.`fct_payments_rides_v2`\n\
      \    where\n    -- to exclude erroneous future dates\n    cast(transaction_date_time_pacific\
      \ as TIMESTAMP) <= timestamp(datetime(current_timestamp(), 'America/Los_Angeles'))\n\
      \        AND participant_id = 'ccjpa'\n    GROUP BY participant_id\n)\nselect\n\
      \    *\nfrom\n    max_recency\nwhere\n-- if the row_condition excludes all rows,\
      \ we need to compare against a default date\n-- to avoid false negatives\ncoalesce(max_timestamp,\
      \ cast('1970-01-01' as TIMESTAMP)) <\n        cast(\n            datetime_add(\n\
      \            cast( timestamp(datetime(current_timestamp(), 'America/Los_Angeles'))\
      \ as datetime),\n        interval -3 day\n        ) as TIMESTAMP)\n```\n\n####\
      \ Metadata\n\nMetabase ID: __1333__\n\nCreated On: __2023-05-02T20:48:18.58334Z__"
    type: analysis
    url: https://dashboards.calitp.org/card/1333
    maturity: medium
    owner:
      name: Charlie Costanzo
      email: charlie.c@jarv.us
    depends_on: []
    config:
      meta:
        average_query_time: '0:00.771'
        last_used_at: '2025-07-09T23:59:42.847999Z'
